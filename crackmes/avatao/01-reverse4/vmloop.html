<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>.vmloop - The Official Rizin Book</title>
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="The Official Rizin Book">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="../../../favicon.png">
        <link rel="stylesheet" href="../../../css/variables.css">
        <link rel="stylesheet" href="../../../css/general.css">
        <link rel="stylesheet" href="../../../css/chrome.css">
        <link rel="stylesheet" href="../../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../highlight.css">
        <link rel="stylesheet" href="../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "light" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../../../index.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../first_steps/history.html"><strong aria-hidden="true">1.1.</strong> History</a></li><li class="chapter-item expanded "><a href="../../../first_steps/overview.html"><strong aria-hidden="true">1.2.</strong> The Framework</a></li><li class="chapter-item expanded "><a href="../../../first_steps/getting_rizin.html"><strong aria-hidden="true">1.3.</strong> Downloading rizin</a></li><li class="chapter-item expanded "><a href="../../../first_steps/compilation_portability.html"><strong aria-hidden="true">1.4.</strong> Compilation and Portability</a></li><li class="chapter-item expanded "><a href="../../../first_steps/windows_compilation.html"><strong aria-hidden="true">1.5.</strong> Compilation on Windows</a></li><li class="chapter-item expanded "><a href="../../../first_steps/compilation_android.html"><strong aria-hidden="true">1.6.</strong> Compilation on Android</a></li></ol></li><li class="chapter-item expanded "><a href="../../../first_steps/intro.html"><strong aria-hidden="true">2.</strong> First Steps</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../first_steps/commandline_flags.html"><strong aria-hidden="true">2.1.</strong> Command-line Flags</a></li><li class="chapter-item expanded "><a href="../../../first_steps/command_format.html"><strong aria-hidden="true">2.2.</strong> Command Format</a></li><li class="chapter-item expanded "><a href="../../../first_steps/expressions.html"><strong aria-hidden="true">2.3.</strong> Expressions</a></li><li class="chapter-item expanded "><a href="../../../first_steps/basic_debugger_session.html"><strong aria-hidden="true">2.4.</strong> Basic Debugger Session</a></li><li class="chapter-item expanded "><a href="../../../first_steps/contributing.html"><strong aria-hidden="true">2.5.</strong> Contributing to rizin</a></li></ol></li><li class="chapter-item expanded "><a href="../../../configuration/intro.html"><strong aria-hidden="true">3.</strong> Configuration</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../configuration/colors.html"><strong aria-hidden="true">3.1.</strong> Colors</a></li><li class="chapter-item expanded "><a href="../../../configuration/evars.html"><strong aria-hidden="true">3.2.</strong> Configuration Variables</a></li><li class="chapter-item expanded "><a href="../../../configuration/files.html"><strong aria-hidden="true">3.3.</strong> Files</a></li></ol></li><li class="chapter-item expanded "><a href="../../../basic_commands/intro.html"><strong aria-hidden="true">4.</strong> Basic Commands</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../basic_commands/seeking.html"><strong aria-hidden="true">4.1.</strong> Seeking</a></li><li class="chapter-item expanded "><a href="../../../basic_commands/block_size.html"><strong aria-hidden="true">4.2.</strong> Block Size</a></li><li class="chapter-item expanded "><a href="../../../basic_commands/sections.html"><strong aria-hidden="true">4.3.</strong> Sections</a></li><li class="chapter-item expanded "><a href="../../../basic_commands/mapping_files.html"><strong aria-hidden="true">4.4.</strong> Mapping Files</a></li><li class="chapter-item expanded "><a href="../../../basic_commands/print_modes.html"><strong aria-hidden="true">4.5.</strong> Print Modes</a></li><li class="chapter-item expanded "><a href="../../../basic_commands/flags.html"><strong aria-hidden="true">4.6.</strong> Flags</a></li><li class="chapter-item expanded "><a href="../../../basic_commands/write.html"><strong aria-hidden="true">4.7.</strong> Write</a></li><li class="chapter-item expanded "><a href="../../../basic_commands/zoom.html"><strong aria-hidden="true">4.8.</strong> Zoom</a></li><li class="chapter-item expanded "><a href="../../../basic_commands/yank_paste.html"><strong aria-hidden="true">4.9.</strong> Yank/Paste</a></li><li class="chapter-item expanded "><a href="../../../basic_commands/comparing_bytes.html"><strong aria-hidden="true">4.10.</strong> Comparing Bytes</a></li><li class="chapter-item expanded "><a href="../../../basic_commands/sdb.html"><strong aria-hidden="true">4.11.</strong> SDB</a></li><li class="chapter-item expanded "><a href="../../../basic_commands/dietline.html"><strong aria-hidden="true">4.12.</strong> Dietline</a></li></ol></li><li class="chapter-item expanded "><a href="../../../visual_mode/intro.html"><strong aria-hidden="true">5.</strong> Visual mode</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../visual_mode/visual_disassembly.html"><strong aria-hidden="true">5.1.</strong> Visual Disassembly</a></li><li class="chapter-item expanded "><a href="../../../visual_mode/visual_assembler.html"><strong aria-hidden="true">5.2.</strong> Visual Assembler</a></li><li class="chapter-item expanded "><a href="../../../visual_mode/visual_configuration_editor.html"><strong aria-hidden="true">5.3.</strong> Visual Configuration Editor</a></li><li class="chapter-item expanded "><a href="../../../visual_mode/visual_panels.html"><strong aria-hidden="true">5.4.</strong> Visual Panels</a></li></ol></li><li class="chapter-item expanded "><a href="../../../search_bytes/intro.html"><strong aria-hidden="true">6.</strong> Searching bytes</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../search_bytes/basic_searches.html"><strong aria-hidden="true">6.1.</strong> Basic Searches</a></li><li class="chapter-item expanded "><a href="../../../search_bytes/configurating_the_search.html"><strong aria-hidden="true">6.2.</strong> Configurating the Search</a></li><li class="chapter-item expanded "><a href="../../../search_bytes/pattern_search.html"><strong aria-hidden="true">6.3.</strong> Pattern Search</a></li><li class="chapter-item expanded "><a href="../../../search_bytes/automation.html"><strong aria-hidden="true">6.4.</strong> Automation</a></li><li class="chapter-item expanded "><a href="../../../search_bytes/backward_search.html"><strong aria-hidden="true">6.5.</strong> Backward Search</a></li><li class="chapter-item expanded "><a href="../../../search_bytes/search_in_assembly.html"><strong aria-hidden="true">6.6.</strong> Search in Assembly</a></li><li class="chapter-item expanded "><a href="../../../search_bytes/searching_aes_keys.html"><strong aria-hidden="true">6.7.</strong> Searching for AES Keys</a></li></ol></li><li class="chapter-item expanded "><a href="../../../disassembling/intro.html"><strong aria-hidden="true">7.</strong> Disassembling</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../disassembling/adding_metadata.html"><strong aria-hidden="true">7.1.</strong> Adding Metadata</a></li><li class="chapter-item expanded "><a href="../../../disassembling/esil.html"><strong aria-hidden="true">7.2.</strong> ESIL</a></li></ol></li><li class="chapter-item expanded "><a href="../../../analysis/intro.html"><strong aria-hidden="true">8.</strong> Analysis</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../analysis/code_analysis.html"><strong aria-hidden="true">8.1.</strong> Code Analysis</a></li><li class="chapter-item expanded "><a href="../../../analysis/variables.html"><strong aria-hidden="true">8.2.</strong> Variables</a></li><li class="chapter-item expanded "><a href="../../../analysis/types.html"><strong aria-hidden="true">8.3.</strong> Types</a></li><li class="chapter-item expanded "><a href="../../../analysis/calling_conventions.html"><strong aria-hidden="true">8.4.</strong> Calling Conventions</a></li><li class="chapter-item expanded "><a href="../../../analysis/vtables.html"><strong aria-hidden="true">8.5.</strong> Virtual Tables</a></li><li class="chapter-item expanded "><a href="../../../analysis/syscalls.html"><strong aria-hidden="true">8.6.</strong> Syscalls</a></li><li class="chapter-item expanded "><a href="../../../analysis/emulation.html"><strong aria-hidden="true">8.7.</strong> Emulation</a></li><li class="chapter-item expanded "><a href="../../../analysis/symbols.html"><strong aria-hidden="true">8.8.</strong> Symbols information</a></li><li class="chapter-item expanded "><a href="../../../signatures/zignatures.html"><strong aria-hidden="true">8.9.</strong> Signatures</a></li><li class="chapter-item expanded "><a href="../../../analysis/graphs.html"><strong aria-hidden="true">8.10.</strong> Graph commands</a></li></ol></li><li class="chapter-item expanded "><a href="../../../scripting/intro.html"><strong aria-hidden="true">9.</strong> Scripting</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../scripting/loops.html"><strong aria-hidden="true">9.1.</strong> Loops</a></li><li class="chapter-item expanded "><a href="../../../scripting/macros.html"><strong aria-hidden="true">9.2.</strong> Macros</a></li><li class="chapter-item expanded "><a href="../../../scripting/rz-pipe.html"><strong aria-hidden="true">9.3.</strong> Rz-pipe</a></li></ol></li><li class="chapter-item expanded "><a href="../../../debugger/intro.html"><strong aria-hidden="true">10.</strong> Debugger</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../debugger/getting_started.html"><strong aria-hidden="true">10.1.</strong> Getting Started</a></li><li class="chapter-item expanded "><a href="../../../debugger/migration.html"><strong aria-hidden="true">10.2.</strong> Migration from ida, GDB or WinDBG</a></li><li class="chapter-item expanded "><a href="../../../debugger/registers.html"><strong aria-hidden="true">10.3.</strong> Registers</a></li><li class="chapter-item expanded "><a href="../../../debugger/memory_maps.html"><strong aria-hidden="true">10.4.</strong> Memory Maps</a></li><li class="chapter-item expanded "><a href="../../../debugger/heap.html"><strong aria-hidden="true">10.5.</strong> Heap</a></li><li class="chapter-item expanded "><a href="../../../debugger/files.html"><strong aria-hidden="true">10.6.</strong> Files</a></li><li class="chapter-item expanded "><a href="../../../debugger/revdebug.html"><strong aria-hidden="true">10.7.</strong> Reverse Debugging</a></li><li class="chapter-item expanded "><a href="../../../debugger/windows_messages.html"><strong aria-hidden="true">10.8.</strong> Windows Messages</a></li></ol></li><li class="chapter-item expanded "><a href="../../../debugger/remoting_capabilities.html"><strong aria-hidden="true">11.</strong> Remote Access</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../debugger/remote_gdb.html"><strong aria-hidden="true">11.1.</strong> Remote GDB</a></li><li class="chapter-item expanded "><a href="../../../debugger/windbg.html"><strong aria-hidden="true">11.2.</strong> Remote WinDbg</a></li></ol></li><li class="chapter-item expanded "><a href="../../../tools/intro.html"><strong aria-hidden="true">12.</strong> Command Line Tools</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../tools/rz-ax/intro.html"><strong aria-hidden="true">12.1.</strong> Rz-ax</a></li><li class="chapter-item expanded "><a href="../../../tools/rz-find/intro.html"><strong aria-hidden="true">12.2.</strong> Rz-find</a></li><li class="chapter-item expanded "><a href="../../../tools/rz-run/intro.html"><strong aria-hidden="true">12.3.</strong> Rz-run</a></li><li class="chapter-item expanded "><a href="../../../tools/rz-bin/intro.html"><strong aria-hidden="true">12.4.</strong> Rz-bin</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../tools/rz-bin/file_identification.html"><strong aria-hidden="true">12.4.1.</strong> File Identification</a></li><li class="chapter-item expanded "><a href="../../../tools/rz-bin/entrypoints.html"><strong aria-hidden="true">12.4.2.</strong> Entrypoint</a></li><li class="chapter-item expanded "><a href="../../../tools/rz-bin/imports.html"><strong aria-hidden="true">12.4.3.</strong> Imports</a></li><li class="chapter-item expanded "><a href="../../../tools/rz-bin/exports.html"><strong aria-hidden="true">12.4.4.</strong> Exports</a></li><li class="chapter-item expanded "><a href="../../../tools/rz-bin/symbols.html"><strong aria-hidden="true">12.4.5.</strong> Symbols (exports)</a></li><li class="chapter-item expanded "><a href="../../../tools/rz-bin/libraries.html"><strong aria-hidden="true">12.4.6.</strong> Libraries</a></li><li class="chapter-item expanded "><a href="../../../tools/rz-bin/strings.html"><strong aria-hidden="true">12.4.7.</strong> Strings</a></li><li class="chapter-item expanded "><a href="../../../tools/rz-bin/program_sections.html"><strong aria-hidden="true">12.4.8.</strong> Program Sections</a></li></ol></li><li class="chapter-item expanded "><a href="../../../tools/rz-diff/intro.html"><strong aria-hidden="true">12.5.</strong> Rz-diff</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../tools/rz-diff/binary_diffing.html"><strong aria-hidden="true">12.5.1.</strong> Binary Diffing</a></li></ol></li><li class="chapter-item expanded "><a href="../../../tools/rz-asm/intro.html"><strong aria-hidden="true">12.6.</strong> Rz-asm</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../tools/rz-asm/assemble.html"><strong aria-hidden="true">12.6.1.</strong> Assemble</a></li><li class="chapter-item expanded "><a href="../../../tools/rz-asm/disassemble.html"><strong aria-hidden="true">12.6.2.</strong> Disassemble</a></li><li class="chapter-item expanded "><a href="../../../tools/rz-asm/config.html"><strong aria-hidden="true">12.6.3.</strong> Configuration</a></li></ol></li><li class="chapter-item expanded "><a href="../../../tools/rz-gg/rz-gg.html"><strong aria-hidden="true">12.7.</strong> Rz-gg</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../tools/rz-gg/lang.html"><strong aria-hidden="true">12.7.1.</strong> Language</a></li></ol></li><li class="chapter-item expanded "><a href="../../../tools/rz-hash/intro.html"><strong aria-hidden="true">12.8.</strong> Rz-hash</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../tools/rz-hash/rz-hash_tool.html"><strong aria-hidden="true">12.8.1.</strong> Rz-hash Tool</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../plugins/intro.html"><strong aria-hidden="true">13.</strong> Plugins</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../plugins/ioplugins.html"><strong aria-hidden="true">13.1.</strong> IO plugins</a></li><li class="chapter-item expanded "><a href="../../../plugins/dev-asm.html"><strong aria-hidden="true">13.2.</strong> Asm plugins</a></li><li class="chapter-item expanded "><a href="../../../plugins/dev-analysis.html"><strong aria-hidden="true">13.3.</strong> Analysis plugins</a></li><li class="chapter-item expanded "><a href="../../../plugins/dev-bin.html"><strong aria-hidden="true">13.4.</strong> Bin plugins</a></li><li class="chapter-item expanded "><a href="../../../plugins/dev-other.html"><strong aria-hidden="true">13.5.</strong> Other plugins</a></li><li class="chapter-item expanded "><a href="../../../plugins/python.html"><strong aria-hidden="true">13.6.</strong> Python plugins</a></li><li class="chapter-item expanded "><a href="../../../plugins/debug.html"><strong aria-hidden="true">13.7.</strong> Debugging</a></li><li class="chapter-item expanded "><a href="../../../plugins/testing.html"><strong aria-hidden="true">13.8.</strong> Testing</a></li><li class="chapter-item expanded "><a href="../../../plugins/rz-pm.html"><strong aria-hidden="true">13.9.</strong> Packaging</a></li></ol></li><li class="chapter-item expanded "><a href="../../../crackmes/intro.html"><strong aria-hidden="true">14.</strong> Crackmes</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../crackmes/ioli/intro.html"><strong aria-hidden="true">14.1.</strong> IOLI</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../crackmes/ioli/ioli_0x00.html"><strong aria-hidden="true">14.1.1.</strong> IOLI 0x00</a></li><li class="chapter-item expanded "><a href="../../../crackmes/ioli/ioli_0x01.html"><strong aria-hidden="true">14.1.2.</strong> IOLI 0x01</a></li><li class="chapter-item expanded "><a href="../../../crackmes/ioli/ioli_0x02.html"><strong aria-hidden="true">14.1.3.</strong> IOLI 0x02</a></li><li class="chapter-item expanded "><a href="../../../crackmes/ioli/ioli_0x03.html"><strong aria-hidden="true">14.1.4.</strong> IOLI 0x03</a></li><li class="chapter-item expanded "><a href="../../../crackmes/ioli/ioli_0x04.html"><strong aria-hidden="true">14.1.5.</strong> IOLI 0x04</a></li><li class="chapter-item expanded "><a href="../../../crackmes/ioli/ioli_0x05.html"><strong aria-hidden="true">14.1.6.</strong> IOLI 0x05</a></li><li class="chapter-item expanded "><a href="../../../crackmes/ioli/ioli_0x06.html"><strong aria-hidden="true">14.1.7.</strong> IOLI 0x06</a></li><li class="chapter-item expanded "><a href="../../../crackmes/ioli/ioli_0x07.html"><strong aria-hidden="true">14.1.8.</strong> IOLI 0x07</a></li><li class="chapter-item expanded "><a href="../../../crackmes/ioli/ioli_0x08.html"><strong aria-hidden="true">14.1.9.</strong> IOLI 0x08</a></li><li class="chapter-item expanded "><a href="../../../crackmes/ioli/ioli_0x09.html"><strong aria-hidden="true">14.1.10.</strong> IOLI 0x09</a></li></ol></li><li class="chapter-item expanded "><a href="../../../crackmes/avatao/01-reverse4/intro.html"><strong aria-hidden="true">14.2.</strong> Avatao R3v3rs3 4</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../crackmes/avatao/01-reverse4/rizin.html"><strong aria-hidden="true">14.2.1.</strong> .rizin</a></li><li class="chapter-item expanded "><a href="../../../crackmes/avatao/01-reverse4/first_steps.html"><strong aria-hidden="true">14.2.2.</strong> .first_steps</a></li><li class="chapter-item expanded "><a href="../../../crackmes/avatao/01-reverse4/main.html"><strong aria-hidden="true">14.2.3.</strong> .main</a></li><li class="chapter-item expanded "><a href="../../../crackmes/avatao/01-reverse4/vmloop.html" class="active"><strong aria-hidden="true">14.2.4.</strong> .vmloop</a></li><li class="chapter-item expanded "><a href="../../../crackmes/avatao/01-reverse4/instructionset.html"><strong aria-hidden="true">14.2.5.</strong> .instructionset</a></li><li class="chapter-item expanded "><a href="../../../crackmes/avatao/01-reverse4/bytecode.html"><strong aria-hidden="true">14.2.6.</strong> .bytecode</a></li><li class="chapter-item expanded "><a href="../../../crackmes/avatao/01-reverse4/outro.html"><strong aria-hidden="true">14.2.7.</strong> .outro</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../refcard/intro.html"><strong aria-hidden="true">15.</strong> Reference Card</a></li><li class="chapter-item expanded "><a href="../../../credits/credits.html"><strong aria-hidden="true">16.</strong> Acknowledgments</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">The Official Rizin Book</h1>

                    <div class="right-buttons">
                        <a href="../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2><a class="header" href="#vmloop" id="vmloop">.vmloop</a></h2>
<pre><code>[offset]&gt; fcn.vmloop
</code></pre>
<p><img src="img/vmloop/bb-0a45.png" alt="vmloop bb-0a45" /></p>
<p>Well, that seems disappointingly short, but no worries, we have plenty to
reverse yet. The thing is that this function uses a jump table at 0x00400a74,</p>
<p><img src="img/vmloop/bb-0a74.png" alt="vmloop bb-0a74" /></p>
<p>and rizin can't yet recognize jump tables
(<a href="https://github.com/rizinorg/rizin/issues/3201">Issue 3201</a>), so the analysis of
this function is a bit incomplete. This means that we can't really use the graph
view now, so either we just use visual mode, or fix those basic blocks. The
entire function is just 542 bytes long, so we certainly could reverse it without
the aid of the graph mode, but since this writeup aims to include as much r2
wisdom as possible, I'm going to show you how to define basic blocks.</p>
<p>First, lets analyze what we already have! First, <em>rdi</em> is put into local_3.
Since the application is a 64bit Linux executable, we know that <em>rdi</em> is the
first function argument (as you may have recognized, the automatic analysis of
arguments and local variables was not entirely correct), and we also know that
<em>vmloop</em>'s first argument is the bytecode. So lets rename local_3:</p>
<pre><code>:&gt; afvn local_3 bytecode
</code></pre>
<p>Next, <em>sym.memory</em> is put into another local variable at <em>rbp-8</em> that rizin did not
recognize. So let's define it!</p>
<pre><code>:&gt; afv 8 memory qword
</code></pre>
<blockquote>
<p><em><strong>rizin tip</strong></em>: The <em>afv [idx] [name] [type]</em> command is used to define local
variable at [frame pointer - idx] with the name [name] and type [type]. You
can also remove local variables using the <em>afv- [idx]</em> command.</p>
</blockquote>
<p>In the next block, the program checks one byte of bytecode, and if it is 0, the
function returns with 1.</p>
<p><img src="img/vmloop/bb-0c4d.png" alt="vmloop bb-0c4d" /></p>
<p>If that byte is not zero, the program subtracts 0x41 from it, and compares the
result to 0x17. If it is above 0x17, we get the dreaded &quot;Wrong!&quot; message, and
the function returns with 0. This basically means that valid bytecodes are ASCII
characters in the range of &quot;A&quot; (0x41) through &quot;X&quot; (0x41 + 0x17). If the bytecode
is valid, we arrive at the code piece that uses the jump table:</p>
<p><img src="img/vmloop/bb-0a74.png" alt="vmloop bb-0a74" /></p>
<p>The jump table's base is at 0x400ec0, so lets define that memory area as a
series of qwords:</p>
<pre><code>[0x00400a74]&gt; s 0x00400ec0
[0x00400ec0]&gt; Cd 8 @@=`?s $$ $$+8*0x17 8`
</code></pre>
<blockquote>
<p><em><strong>rizin tip</strong></em>: Except for the <em>?s</em>, all parts of this command should be
familiar now, but lets recap it! <em>Cd</em> defines a memory area as data, and 8 is
the size of that memory area. <em>@@</em> is an iterator that make the preceding
command run for every element that <em>@@</em> holds. In this example it holds a
series generated using the <em>?s</em> command. <em>?s</em> simply generates a series from
the current seek (<em>$$</em>) to current seek + 8<em>0x17 (</em>$$+8<em>0x17</em>) with a step
of 8.</p>
</blockquote>
<p>This is how the disassembly looks like after we add this metadata:</p>
<pre><code>[0x00400ec0]&gt; pd 0x18
            ; DATA XREF from 0x00400a76 (unk)
            0x00400ec0 .qword 0x0000000000400a80
            0x00400ec8 .qword 0x0000000000400c04
            0x00400ed0 .qword 0x0000000000400b6d
            0x00400ed8 .qword 0x0000000000400b17
            0x00400ee0 .qword 0x0000000000400c04
            0x00400ee8 .qword 0x0000000000400c04
            0x00400ef0 .qword 0x0000000000400c04
            0x00400ef8 .qword 0x0000000000400c04
            0x00400f00 .qword 0x0000000000400aec
            0x00400f08 .qword 0x0000000000400bc1
            0x00400f10 .qword 0x0000000000400c04
            0x00400f18 .qword 0x0000000000400c04
            0x00400f20 .qword 0x0000000000400c04
            0x00400f28 .qword 0x0000000000400c04
            0x00400f30 .qword 0x0000000000400c04
            0x00400f38 .qword 0x0000000000400b42
            0x00400f40 .qword 0x0000000000400c04
            0x00400f48 .qword 0x0000000000400be5
            0x00400f50 .qword 0x0000000000400ab6
            0x00400f58 .qword 0x0000000000400c04
            0x00400f60 .qword 0x0000000000400c04
            0x00400f68 .qword 0x0000000000400c04
            0x00400f70 .qword 0x0000000000400c04
            0x00400f78 .qword 0x0000000000400b99
</code></pre>
<p>As we can see, the address 0x400c04 is used a lot, and besides that there are 9
different addresses. Lets see that 0x400c04 first!</p>
<p><img src="img/vmloop/bb-0c04.png" alt="vmloop bb-0c04" /></p>
<p>We get the message &quot;Wrong!&quot;, and the function just returns 0. This means that
those are not valid instructions (they are valid bytecode though, they can be
e.g. parameters!) We should flag 0x400c04 accordingly:</p>
<pre><code>[0x00400ec0]&gt; f not_instr @ 0x0000000000400c04
</code></pre>
<p>As for the other offsets, they all seem to be doing something meaningful, so we
can assume they belong to valid instructions. I'm going to flag them using the
instructions' ASCII values:</p>
<pre><code>[0x00400ec0]&gt; f instr_A @ 0x0000000000400a80
[0x00400ec0]&gt; f instr_C @ 0x0000000000400b6d
[0x00400ec0]&gt; f instr_D @ 0x0000000000400b17
[0x00400ec0]&gt; f instr_I @ 0x0000000000400aec
[0x00400ec0]&gt; f instr_J @ 0x0000000000400bc1
[0x00400ec0]&gt; f instr_P @ 0x0000000000400b42
[0x00400ec0]&gt; f instr_R @ 0x0000000000400be5
[0x00400ec0]&gt; f instr_S @ 0x0000000000400ab6
[0x00400ec0]&gt; f instr_X @ 0x0000000000400b99
</code></pre>
<p>Ok, so these offsets were not on the graph, so it is time to define basic blocks
for them!</p>
<blockquote>
<p><em><strong>rizin tip</strong></em>: You can define basic blocks using the <em>afb+</em> command. You have
to supply what function the block belongs to, where does it start, and what is
its size. If the block ends in a jump, you have to specify where does it jump
too. If the jump is a conditional jump, the false branch's destination address
should be specified too.</p>
</blockquote>
<p>We can get the start and end addresses of these basic blocks from the full disasm
of <em>vmloop</em>.</p>
<p><img src="img/vmloop/vmloop-full.png" alt="vmloop full" /></p>
<p>As I've mentioned previously, the function itself is pretty short, and easy to
read, especially with our annotations. But a promise is a promise, so here is
how we can create the missing bacic blocks for the instructions:</p>
<pre><code>[0x00400ec0]&gt; afb+ 0x00400a45 0x00400a80 0x00400ab6-0x00400a80 0x400c15
[0x00400ec0]&gt; afb+ 0x00400a45 0x00400ab6 0x00400aec-0x00400ab6 0x400c15
[0x00400ec0]&gt; afb+ 0x00400a45 0x00400aec 0x00400b17-0x00400aec 0x400c15
[0x00400ec0]&gt; afb+ 0x00400a45 0x00400b17 0x00400b42-0x00400b17 0x400c15
[0x00400ec0]&gt; afb+ 0x00400a45 0x00400b42 0x00400b6d-0x00400b42 0x400c15
[0x00400ec0]&gt; afb+ 0x00400a45 0x00400b6d 0x00400b99-0x00400b6d 0x400c15
[0x00400ec0]&gt; afb+ 0x00400a45 0x00400b99 0x00400bc1-0x00400b99 0x400c15
[0x00400ec0]&gt; afb+ 0x00400a45 0x00400bc1 0x00400be5-0x00400bc1 0x400c15
[0x00400ec0]&gt; afb+ 0x00400a45 0x00400be5 0x00400c04-0x00400be5 0x400c15
</code></pre>
<p>It is also apparent from the disassembly that besides the instructions there
are three more basic blocks. Lets create them too!</p>
<pre><code>[0x00400ec0]&gt; afb+ 0x00400a45 0x00400c15 0x00400c2d-0x00400c15 0x400c3c 0x00400c2d
[0x00400ec0]&gt; afb+ 0x00400a45 0x00400c2d 0x00400c3c-0x00400c2d 0x400c4d 0x00400c3c
[0x00400ec0]&gt; afb+ 0x00400a45 0x00400c3c 0x00400c4d-0x00400c3c 0x400c61
</code></pre>
<p>Note that the basic blocks starting at 0x00400c15 and 0x00400c2d ending in a
conditional jump, so we had to set the false branch's destination too!</p>
<p>And here is the graph in its full glory after a bit of manual restructuring:</p>
<p><img src="img/vmloop/vmloop-graph-reconstructed_full.png" alt="vmloop graph" /></p>
<p>I think it worth it, don't you? :) (Well, the restructuring did not really worth
it, because it is apparently not stored when you save the project.)</p>
<blockquote>
<p><em><strong>rizin tip</strong></em>: You can move the selected node around in graph view using the
HJKL keys.</p>
</blockquote>
<p>By the way, here is how IDA's graph of this same function looks like for comparison:</p>
<p><img src="img/vmloop_ida.png" alt="IDA graph" /></p>
<p>As we browse through the disassembly of the <em>instr_LETTER</em> basic blocks, we
should realize a few things. The first: all of the instructions starts with a
sequence like these:</p>
<p><img src="img/vmloop/bb-0a80.png" alt="vmloop bb-0a80" /></p>
<p><img src="img/vmloop/bb-0ab6.png" alt="vmloop bb-0ab6" /></p>
<p>It became clear now that the 9 dwords at <em>sym.instr_dirty</em> are not simply
indicators that an instruction got executed, but they are used to count how many
times an instruction got called. Also I should have realized earlier that
<em>sym.good_if_le_9</em> (0x6020f0) is part of this 9 dword array, but yeah, well, I
didn't, I have to live with it... Anyways, what the condition
&quot;<em>sym.good_if_le_9</em> have to be lesser or equal 9&quot; really means is that <em>instr_P</em>
can not be executed more than 9 times:</p>
<p><img src="img/vmloop/bb-0b42.png" alt="vmloop bb-0b42" /></p>
<p>Another similarity of the instructions is that 7 of them calls a function with
either one or two parameters, where the parameters are the next, or the next two
bytecodes. One parameter example:</p>
<p><img src="img/vmloop/bb-0aec.png" alt="vmloop bb-0aec" /></p>
<p>And a two parameters example:</p>
<p><img src="img/vmloop/bb-0a80_full.png" alt="vmloop bb-0a80_full" /></p>
<p>We should also realize that these blocks put the number of bytes they eat up of
the bytecode (1 byte instruction + 1 or 2 bytes arguments = 2 or 3) into a local
variable at 0xc. rizin did not recognize this local var, so lets do it manually!</p>
<pre><code>:&gt; afv 0xc instr_ptr_step dword
</code></pre>
<p>If we look at <em>instr_J</em> we can see that this is an exception to the above rule,
since it puts the return value of the called function into <em>instr_ptr_step</em>
instead of a constant 2 or 3:</p>
<p><img src="img/vmloop/bb-0bc1.png" alt="vmloop bb-0bc1" /></p>
<p>And speaking of exceptions, here are the two instructions that do not call functions:</p>
<p><img src="img/vmloop/bb-0be5.png" alt="vmloop bb-0be5" /></p>
<p>This one simply puts the next bytecode (the first the argument) into <em>eax</em>, and
jumps to the end of <em>vmloop</em>. So this is the VM's <em>ret</em> instruction, and we know
that <em>vmloop</em> has to return &quot;*&quot;, so &quot;R*&quot; should be the last two bytes of our
bytecode.</p>
<p>The next one that does not call a function:</p>
<p><img src="img/vmloop/bb-0b6d.png" alt="vmloop bb-0b6d" /></p>
<p>This is a one argument instruction, and it puts its argument to 0x6020c0. Flag
that address!</p>
<pre><code>:&gt; f sym.written_by_instr_C 4 @ 0x6020c0
</code></pre>
<p>Oh, and by the way, I do have a hunch that <em>instr_C</em> also had a function call in
the original code, but it got inlined by the compiler. Anyways, so far we have
these two instructions:</p>
<ul>
<li><em>instr_R(a1):</em> returns with <em>a1</em></li>
<li><em>instr_C(a1):</em> writes <em>a1</em> to <em>sym.written_by_instr_C</em></li>
</ul>
<p>And we also know that these accept one argument,</p>
<ul>
<li>instr_I</li>
<li>instr_D</li>
<li>instr_P</li>
<li>instr_X</li>
<li>instr_J</li>
</ul>
<p>and these accept two:</p>
<ul>
<li>instr_A</li>
<li>instr_S</li>
</ul>
<p>What remains is the reversing of the seven functions that are called by the
instructions, and finally the construction of a valid bytecode that gives us the
flag.</p>
<p>###instr_A</p>
<p>The function this instruction calls is at offset 0x40080d, so lets seek there!</p>
<pre><code>[offset]&gt; 0x40080d
</code></pre>
<blockquote>
<p><em><strong>rizin tip:</strong></em> In visual mode you can just hit &lt;Enter&gt; when the current line is
a jump or a call, and rizin will seek to the destination address.</p>
</blockquote>
<p>If we seek to that address from the graph mode, we are presented with a message
that says &quot;Not in a function. Type 'df' to define it here. This is because the
function is called from a basic block rizin did not recognize, so rizin could not
find the function either. Lets obey, and type <em>df</em>! A function is indeed created, but
we want some meaningful name for it. So press <em>dr</em> while still in visual mode,
and name this function <em>instr_A</em>!</p>
<p><img src="img/instr_A/instr_A_minimap.png" alt="instr_A minimap" /></p>
<blockquote>
<p><em><strong>rizin tip:</strong></em> You should realize that these commands are all part of the same
menu system in visual mode I was talking about when we first used <em>Cd</em> to
declare <em>sym.memory</em> as data.</p>
</blockquote>
<p>Ok, now we have our shiny new <em>fcn.instr_A</em>, lets reverse it! We can see from
the shape of the minimap that probably there is some kind cascading
if-then-elif, or a switch-case statement involved in this function. This is one
of the reasons the minimap is so useful: you can recognize some patterns at a
glance, which can help you in your analysis (remember the easily recognizable
for loop from a few paragraphs before?) So, the minimap is cool and useful, but
I've just realized that I did not yet show you the full graph mode, so I'm
going to do this using full graph. The first basic blocks:</p>
<p><img src="img/instr_A/bb-080d.png" alt="instr_A bb-080d" /></p>
<p>The two function arguments (<em>rdi</em> and <em>rsi</em>) are stored in local variables, and
the first is compared to 0. If it is, the function returns (you can see it on
the minimap), otherwise the same check is executed on the second argument. The
function returns from here too, if the argument is zero. Although this function
is really tiny, I am going to stick with my methodology, and rename the local
vars:</p>
<pre><code>:&gt; afvn local_1 arg1
:&gt; afvn local_2 arg2
</code></pre>
<p>And we have arrived to the predicted switch-case statement, and we can see that
<em>arg1</em>'s value is checked against &quot;M&quot;, &quot;P&quot;, and &quot;C&quot;.</p>
<p><img src="img/instr_A/switch-values.png" alt="instr_A switch values" /></p>
<p>This is the &quot;M&quot; branch:</p>
<p><img src="img/instr_A/switch-M.png" alt="instr_A switch-M" /></p>
<p>It basically loads an address from offset 0x602088 and adds <em>arg2</em> to the byte
at that address. As rizin kindly shows us in a comment, 0x602088 initially holds
the address of <em>sym.memory</em>, the area where we have to construct the &quot;Such VM!
MuCH reV3rse!&quot; string. It is safe to assume that somehow we will be able to
modify the value stored at 0x602088, so this &quot;M&quot; branch will be able to modify
bytes other than the first. Based on this assumption, I'll flag 0x602088 as
<em>sym.current_memory_ptr</em>:</p>
<pre><code>:&gt; f sym.current_memory_ptr 8 @ 0x602088
</code></pre>
<p>Moving on to the &quot;P&quot; branch:</p>
<p><img src="img/instr_A/switch-P.png" alt="instr_A switch-P" /></p>
<p>Yes, this is the piece of code that allows us to modify
<em>sym.current_memory_ptr</em>: it adds <em>arg2</em> to it.</p>
<p>Finally, the &quot;C&quot; branch:</p>
<p><img src="img/instr_A/switch-C.png" alt="instr_A switch-C" /></p>
<p>Well, it turned out that <em>instr_C</em> is not the only instruction that modifies 
<em>sym.written_by_instr_C</em>: this piece of code adds <em>arg2</em> to it.</p>
<p>And that was <em>instr_A</em>, lets summarize it! Depending on the first argument, this
instruction does the following:</p>
<ul>
<li><em>arg1</em> == &quot;M&quot;: adds <em>arg2</em> to the byte at <em>sym.current_memory_ptr</em>.</li>
<li><em>arg1</em> == &quot;P&quot;: steps <em>sym.current_memory_ptr</em> by <em>arg2</em> bytes.</li>
<li><em>arg1</em> == &quot;C&quot;: adds <em>arg2</em> to the value at <em>sym.written_by_instr_C</em>.</li>
</ul>
<p>###instr_S</p>
<p>This function is not recognized either, so we have to manually define it like we
did with <em>instr_A</em>. After we do, and take a look at the minimap, scroll through
the basic blocks, it is pretty obvious that these two functions are very-very
similar. We can use <em>rz-diff</em> to see the difference.</p>
<blockquote>
<p><em><strong>rizin tip:</strong></em> rz-diff is used to compare binary files. There's a few options
we can control the type of binary diffing the tool does, and to what kind of
output format we want. One of the cool features is that it can generate
<a href="http://www.darungrim.org/">DarumGrim</a>-style bindiff graphs using the <em>-g</em>
option.</p>
</blockquote>
<p>Since now we want to diff two functions from the same binary, we specify the
offsets with <em>-g</em>, and use reverse4 for both binaries. Also, we create the
graphs for comparing <em>instr_A</em> to <em>instr_S</em> and for comparing <em>instr_S</em> to
<em>instr_A</em>.</p>
<pre><code>[0x00 ~]$ rz-diff -g 0x40080d,0x40089f  reverse4 reverse4 | xdot -
</code></pre>
<p><img src="img/instr_S/graph1.png" alt="instr_S graph1" /></p>
<pre><code>[0x00 ~]$ rz-diff -g 0x40089f,0x40080d  reverse4 reverse4 | xdot -
</code></pre>
<p><img src="img/instr_S/graph2.png" alt="instr_S graph2" /></p>
<p>A sad truth reveals itself after a quick glance at these graphs: rz-diff is a
liar! In theory, grey boxes should be identical, yellow ones should differ only
at some offsets, and red ones should differ seriously. Well this is obviously
not the case here - e.g. the larger grey boxes are clearly not identical. This
is something I'm definitely going to take a deeper look at after I've finished
this writeup.</p>
<p>Anyways, after we get over the shock of being lied to, we can easily recognize
that <em>instr_S</em> is basically a reverse-<em>instr_A</em>: where the latter does addition,
the former does subtraction. To summarize this:</p>
<ul>
<li><em>arg1</em> == &quot;M&quot;: subtracts <em>arg2</em> from the byte at <em>sym.current_memory_ptr</em>.</li>
<li><em>arg1</em> == &quot;P&quot;: steps <em>sym.current_memory_ptr</em> backwards by <em>arg2</em> bytes.</li>
<li><em>arg1</em> == &quot;C&quot;: subtracts <em>arg2</em> from the value at <em>sym.written_by_instr_C</em>.</li>
</ul>
<p>###instr_I</p>
<p><img src="img/instr_I/instr_I.png" alt="instr_I" /></p>
<p>This one is simple, it just calls <em>instr_A(arg1, 1)</em>. As you may have noticed
the function call looks like <code>call fcn.0040080d</code> instead of <code>call fcn.instr_A</code>.
This is because when you save and open a project, function names get lost -
another thing to examine and patch in r2!</p>
<p>###instr_D</p>
<p><img src="img/instr_D/instr_D.png" alt="instr_D" /></p>
<p>Again, simple: it calls <em>instr_S(arg1, 1)</em>.</p>
<p>###instr_P</p>
<p>It's local var rename time again!</p>
<pre><code>:&gt; afvn local_0_1 const_M
:&gt; afvn local_0_2 const_P
:&gt; afvn local_3 arg1
</code></pre>
<p><img src="img/instr_P/instr_P.png" alt="instr_P" /></p>
<p>This function is pretty straightforward also, but there is one oddity: const_M
is never used. I don't know why it is there - maybe it is supposed to be some
kind of distraction? Anyways, this function simply writes <em>arg1</em> to
<em>sym.current_memory_ptr</em>, and than calls <em>instr_I(&quot;P&quot;)</em>. This basically means
that <em>instr_P</em> is used to write one byte, and put the pointer to the next byte.
So far this would seem the ideal instruction to construct most of the &quot;Such VM!
MuCH reV3rse!&quot; string, but remember, this is also the one that can be used only
9 times!</p>
<p>###instr_X</p>
<p>Another simple one, rename local vars anyways!</p>
<pre><code>:&gt; afvn local_1 arg1
</code></pre>
<p><img src="img/instr_X/instr_X.png" alt="instr_X" /></p>
<p>This function XORs the value at <em>sym.current_memory_ptr</em> with <em>arg1</em>.</p>
<p>###instr_J</p>
<p>This one is not as simple as the previous ones, but it's not that complicated
either. Since I'm obviously obsessed with variable renaming:</p>
<pre><code>:&gt; afvn local_3 arg1
:&gt; afvn local_0_4 arg1_and_0x3f
</code></pre>
<p><img src="img/instr_J/instr_J.png" alt="instr_J" /></p>
<p>After the result of <em>arg1 &amp; 0x3f</em> is put into a local variable, <em>arg1 &amp; 0x40</em> is
checked against 0. If it isn't zero, <em>arg1_and_0x3f</em> is negated:</p>
<p><img src="img/instr_J/bb-09e1.png" alt="instr_J bb-09e1" /></p>
<p>The next branching: if <em>arg1</em> &gt;= 0, then the function returns <em>arg1_and_0x3f</em>,</p>
<p><img src="img/instr_J/bb-09e4.png" alt="instr_J bb-09e4" /></p>
<p><img src="img/instr_J/bb-0a1a.png" alt="instr_J bb-0a1a" /></p>
<p>else the function branches again, based on the value of
<em>sym.written_by_instr_C</em>:</p>
<p><img src="img/instr_J/bb-09ef.png" alt="instr_J bb-09ef" /></p>
<p>If it is zero, the function returns 2,</p>
<p><img src="img/instr_J/bb-0a13.png" alt="instr_J bb-0a13" /></p>
<p>else it is checked if <em>arg1_and_0x3f</em> is a negative number,</p>
<p><img src="img/instr_J/bb-09f9.png" alt="instr_J bb-09f9" /></p>
<p>and if it is, <em>sym.good_if_ne_zero</em> is incremented by 1:</p>
<p><img src="img/instr_J/bb-09ff.png" alt="instr_J bb-09ff" /></p>
<p>After all this, the function returns with <em>arg1_and_0x3f</em>:</p>
<p><img src="img/instr_J/bb-0a0e.png" alt="instr_J bb-0a0e" /></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../../../crackmes/avatao/01-reverse4/main.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../../../crackmes/avatao/01-reverse4/instructionset.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../../../crackmes/avatao/01-reverse4/main.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../../../crackmes/avatao/01-reverse4/instructionset.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        
        
        
        <script type="text/javascript">
            window.playpen_copyable = true;
        </script>
        

        

        
        <script src="../../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
